{"version":3,"file":"getPosterSrc.js","names":["getPosterSrc","asset","secrets","fit_mode","height","time","thumbTime","width","params","playbackId","getPlaybackId","searchParams","URLSearchParams","JSON","parse","stringify","_","v","undefined","isSigned","token","generateJwt","signingKeyId","signingKeyPrivate"],"sources":["../../src/util/getPosterSrc.ts"],"sourcesContent":["import {generateJwt} from './generateJwt'\nimport {getPlaybackId} from './getPlaybackId'\nimport {isSigned} from './isSigned'\nimport type {\n  MuxThumbnailUrl,\n  Secrets,\n  SignableSecrets,\n  ThumbnailOptions,\n  VideoAssetDocument,\n} from './types'\n\nexport interface PosterSrcOptions extends ThumbnailOptions {\n  asset: VideoAssetDocument\n  secrets: Secrets | SignableSecrets\n}\n\nexport function getPosterSrc({\n  asset,\n  secrets,\n  fit_mode,\n  height,\n  time = asset.thumbTime,\n  width,\n}: PosterSrcOptions): MuxThumbnailUrl {\n  const params = {fit_mode, height, time, width}\n  const playbackId = getPlaybackId(asset)\n\n  let searchParams = new URLSearchParams(\n    JSON.parse(JSON.stringify(params, (_, v) => v ?? undefined))\n  )\n  if (isSigned(asset, secrets as SignableSecrets)) {\n    const token = generateJwt(\n      playbackId,\n      // eslint-disable-next-line no-warning-comments\n      // @TODO figure out why isSigned doesn't manage to narrow down secrets to SignableSecrets\n      (secrets as SignableSecrets).signingKeyId,\n      (secrets as SignableSecrets).signingKeyPrivate,\n      't',\n      params\n    )\n    searchParams = new URLSearchParams({token})\n  }\n\n  return `https://image.mux.com/${playbackId}/thumbnail.png?${searchParams}`\n}\n"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAcO,SAASA,YAAT,OAO+B;EAAA,IANpCC,KAMoC,QANpCA,KAMoC;EAAA,IALpCC,OAKoC,QALpCA,OAKoC;EAAA,IAJpCC,QAIoC,QAJpCA,QAIoC;EAAA,IAHpCC,MAGoC,QAHpCA,MAGoC;EAAA,qBAFpCC,IAEoC;EAAA,IAFpCA,IAEoC,0BAF7BJ,KAAK,CAACK,SAEuB;EAAA,IADpCC,KACoC,QADpCA,KACoC;EACpC,IAAMC,MAAM,GAAG;IAACL,QAAD;IAAWC,MAAX;IAAmBC,IAAnB;IAAyBE;EAAzB,CAAf;EACA,IAAME,UAAU,GAAG,IAAAC,4BAAA,EAAcT,KAAd,CAAnB;EAEA,IAAIU,YAAY,GAAG,IAAIC,eAAJ,CACjBC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeP,MAAf,EAAuB,CAACQ,CAAD,EAAIC,CAAJ,KAAUA,CAAV,aAAUA,CAAV,cAAUA,CAAV,GAAeC,SAAtC,CAAX,CADiB,CAAnB;;EAGA,IAAI,IAAAC,kBAAA,EAASlB,KAAT,EAAgBC,OAAhB,CAAJ,EAAiD;IAC/C,IAAMkB,KAAK,GAAG,IAAAC,wBAAA,EACZZ,UADY,EAEZ;IACA;IACCP,OAAD,CAA6BoB,YAJjB,EAKXpB,OAAD,CAA6BqB,iBALjB,EAMZ,GANY,EAOZf,MAPY,CAAd;IASAG,YAAY,GAAG,IAAIC,eAAJ,CAAoB;MAACQ;IAAD,CAApB,CAAf;EACD;;EAED,uCAAgCX,UAAhC,4BAA4DE,YAA5D;AACD"}