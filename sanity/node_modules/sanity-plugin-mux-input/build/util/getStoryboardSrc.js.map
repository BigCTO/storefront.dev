{"version":3,"file":"getStoryboardSrc.js","names":["getStoryboardSrc","asset","secrets","playbackId","getPlaybackId","searchParams","URLSearchParams","isSigned","token","generateJwt","signingKeyId","signingKeyPrivate","set"],"sources":["../../src/util/getStoryboardSrc.ts"],"sourcesContent":["import {generateJwt} from './generateJwt'\nimport {getPlaybackId} from './getPlaybackId'\nimport {isSigned} from './isSigned'\nimport type {MuxStoryboardUrl, Secrets, SignableSecrets, VideoAssetDocument} from './types'\n\ninterface StoryboardSrcOptions {\n  asset: VideoAssetDocument\n  secrets: Secrets | SignableSecrets\n}\n\nexport function getStoryboardSrc({asset, secrets}: StoryboardSrcOptions): MuxStoryboardUrl {\n  const playbackId = getPlaybackId(asset)\n  const searchParams = new URLSearchParams()\n\n  if (isSigned(asset, secrets as SignableSecrets)) {\n    const token = generateJwt(\n      playbackId,\n      // eslint-disable-next-line no-warning-comments\n      // @TODO figure out why isSigned doesn't manage to narrow down secrets to SignableSecrets\n      (secrets as SignableSecrets).signingKeyId,\n      (secrets as SignableSecrets).signingKeyPrivate,\n      's'\n    )\n    searchParams.set('token', token)\n  }\n\n  return `https://image.mux.com/${playbackId}/storyboard.vtt?${searchParams}`\n}\n"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAQO,SAASA,gBAAT,OAAoF;EAAA,IAAzDC,KAAyD,QAAzDA,KAAyD;EAAA,IAAlDC,OAAkD,QAAlDA,OAAkD;EACzF,IAAMC,UAAU,GAAG,IAAAC,4BAAA,EAAcH,KAAd,CAAnB;EACA,IAAMI,YAAY,GAAG,IAAIC,eAAJ,EAArB;;EAEA,IAAI,IAAAC,kBAAA,EAASN,KAAT,EAAgBC,OAAhB,CAAJ,EAAiD;IAC/C,IAAMM,KAAK,GAAG,IAAAC,wBAAA,EACZN,UADY,EAEZ;IACA;IACCD,OAAD,CAA6BQ,YAJjB,EAKXR,OAAD,CAA6BS,iBALjB,EAMZ,GANY,CAAd;IAQAN,YAAY,CAACO,GAAb,CAAiB,OAAjB,EAA0BJ,KAA1B;EACD;;EAED,uCAAgCL,UAAhC,6BAA6DE,YAA7D;AACD"}