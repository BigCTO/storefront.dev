{"version":3,"file":"isSigned.js","names":["isSigned","asset","secrets","isAssetSigned","data","playback_ids","policy","areSecretsSignable","console","error","TypeError"],"sources":["../../src/util/isSigned.ts"],"sourcesContent":["import {areSecretsSignable} from './areSecretsSignable'\nimport type {Secrets, VideoAssetDocument} from './types'\n\nexport function isSigned(asset: VideoAssetDocument, secrets: Secrets): boolean {\n  const isAssetSigned = asset.data?.playback_ids?.[0]?.policy === 'signed'\n  if (!isAssetSigned) {\n    return false\n  }\n\n  if (areSecretsSignable(secrets)) {\n    return true\n  }\n  console.error(\n    'Asset is signed',\n    {asset},\n    'but secrets are missing signingKeyId and signingKeyPrivate',\n    secrets\n  )\n  throw new TypeError(`Unable to access asset as signing keys are missing`)\n}\n"],"mappings":";;;;;;;AAAA;;AAGO,SAASA,QAAT,CAAkBC,KAAlB,EAA6CC,OAA7C,EAAwE;EAAA;;EAC7E,IAAMC,aAAa,GAAG,gBAAAF,KAAK,CAACG,IAAN,qFAAYC,YAAZ,0GAA2B,CAA3B,mFAA+BC,MAA/B,MAA0C,QAAhE;;EACA,IAAI,CAACH,aAAL,EAAoB;IAClB,OAAO,KAAP;EACD;;EAED,IAAI,IAAAI,sCAAA,EAAmBL,OAAnB,CAAJ,EAAiC;IAC/B,OAAO,IAAP;EACD;;EACDM,OAAO,CAACC,KAAR,CACE,iBADF,EAEE;IAACR;EAAD,CAFF,EAGE,4DAHF,EAIEC,OAJF;EAMA,MAAM,IAAIQ,SAAJ,sDAAN;AACD"}