{"version":3,"file":"EditThumbnailDialog.js","names":["EditThumbnailDialog","asset","getCurrentTime","onClose","videoReadyToPlay","secrets","dialogId","useId","nextTime","useMemo","assetWithNewThumbnail","thumbTime","useState","saving","setSaving","error","setError","handleSave","useCallback","client","patch","_id","set","commit","returnDocuments","catch","finally","width","getDevicePixelRatio","maxDpr"],"sources":["../../src/components/EditThumbnailDialog.tsx"],"sourcesContent":["import {useId} from '@reach/auto-id'\nimport {Button, Dialog, Stack, Text} from '@sanity/ui'\nimport React, {useCallback, useMemo, useState} from 'react'\nimport {getDevicePixelRatio} from 'use-device-pixel-ratio'\n\nimport client from '../clients/SanityClient'\nimport type {Secrets, VideoAssetDocument} from '../util/types'\nimport {VideoThumbnail} from './VideoSource.styles'\n\nexport interface Props {\n  asset: VideoAssetDocument\n  getCurrentTime: () => number\n  onClose: () => void\n  videoReadyToPlay: boolean\n  secrets: Secrets\n}\nexport default function EditThumbnailDialog({\n  asset,\n  getCurrentTime,\n  onClose,\n  videoReadyToPlay,\n  secrets,\n}: Props) {\n  const dialogId = `EditThumbnailDialog${useId()}`\n  const nextTime = useMemo(() => getCurrentTime(), [getCurrentTime])\n  const assetWithNewThumbnail = useMemo(() => ({...asset, thumbTime: nextTime}), [asset, nextTime])\n  const [saving, setSaving] = useState(false)\n  const [error, setError] = useState<Error | null>(null)\n  const handleSave = useCallback(() => {\n    setSaving(true)\n    client\n      .patch(asset._id!)\n      .set({thumbTime: nextTime})\n      .commit({returnDocuments: false})\n      .catch(setError)\n      .finally(() => setSaving(false))\n  }, [asset._id, nextTime])\n  const width = 300 * getDevicePixelRatio({maxDpr: 2})\n\n  if (error) {\n    // eslint-disable-next-line no-warning-comments\n    // @TODO handle errors more gracefully\n    throw error\n  }\n\n  return (\n    <Dialog\n      id={dialogId}\n      header=\"Edit thumbnail\"\n      onClose={onClose}\n      footer={\n        <Stack padding={3}>\n          <Button\n            key=\"thumbnail\"\n            mode=\"ghost\"\n            tone=\"primary\"\n            loading={saving}\n            onClick={handleSave}\n            disabled={videoReadyToPlay === false}\n            text=\"Set new thumbnail\"\n          />\n        </Stack>\n      }\n    >\n      <Stack space={3} padding={3}>\n        <Stack space={2}>\n          <Text size={1} weight=\"semibold\">\n            Current:\n          </Text>\n          <VideoThumbnail asset={asset} secrets={secrets} width={width} />\n        </Stack>\n        <Stack space={2}>\n          <Text size={1} weight=\"semibold\">\n            New:\n          </Text>\n          <VideoThumbnail asset={assetWithNewThumbnail} secrets={secrets} width={width} />\n        </Stack>\n      </Stack>\n    </Dialog>\n  )\n}\n"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AAEA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;AASe,SAASA,mBAAT,OAML;EAAA,IALRC,KAKQ,QALRA,KAKQ;EAAA,IAJRC,cAIQ,QAJRA,cAIQ;EAAA,IAHRC,OAGQ,QAHRA,OAGQ;EAAA,IAFRC,gBAEQ,QAFRA,gBAEQ;EAAA,IADRC,OACQ,QADRA,OACQ;EACR,IAAMC,QAAQ,gCAAyB,IAAAC,aAAA,GAAzB,CAAd;EACA,IAAMC,QAAQ,GAAG,IAAAC,cAAA,EAAQ,MAAMP,cAAc,EAA5B,EAAgC,CAACA,cAAD,CAAhC,CAAjB;EACA,IAAMQ,qBAAqB,GAAG,IAAAD,cAAA,EAAQ,sCAAWR,KAAX;IAAkBU,SAAS,EAAEH;EAA7B,EAAR,EAAiD,CAACP,KAAD,EAAQO,QAAR,CAAjD,CAA9B;;EACA,gBAA4B,IAAAI,eAAA,EAAS,KAAT,CAA5B;EAAA;EAAA,IAAOC,MAAP;EAAA,IAAeC,SAAf;;EACA,iBAA0B,IAAAF,eAAA,EAAuB,IAAvB,CAA1B;EAAA;EAAA,IAAOG,KAAP;EAAA,IAAcC,QAAd;;EACA,IAAMC,UAAU,GAAG,IAAAC,kBAAA,EAAY,MAAM;IACnCJ,SAAS,CAAC,IAAD,CAAT;;IACAK,qBAAA,CACGC,KADH,CACSnB,KAAK,CAACoB,GADf,EAEGC,GAFH,CAEO;MAACX,SAAS,EAAEH;IAAZ,CAFP,EAGGe,MAHH,CAGU;MAACC,eAAe,EAAE;IAAlB,CAHV,EAIGC,KAJH,CAIST,QAJT,EAKGU,OALH,CAKW,MAAMZ,SAAS,CAAC,KAAD,CAL1B;EAMD,CARkB,EAQhB,CAACb,KAAK,CAACoB,GAAP,EAAYb,QAAZ,CARgB,CAAnB;EASA,IAAMmB,KAAK,GAAG,MAAM,IAAAC,wCAAA,EAAoB;IAACC,MAAM,EAAE;EAAT,CAApB,CAApB;;EAEA,IAAId,KAAJ,EAAW;IACT;IACA;IACA,MAAMA,KAAN;EACD;;EAED,oBACE,6BAAC,UAAD;IACE,EAAE,EAAET,QADN;IAEE,MAAM,EAAC,gBAFT;IAGE,OAAO,EAAEH,OAHX;IAIE,MAAM,eACJ,6BAAC,SAAD;MAAO,OAAO,EAAE;IAAhB,gBACE,6BAAC,UAAD;MACE,GAAG,EAAC,WADN;MAEE,IAAI,EAAC,OAFP;MAGE,IAAI,EAAC,SAHP;MAIE,OAAO,EAAEU,MAJX;MAKE,OAAO,EAAEI,UALX;MAME,QAAQ,EAAEb,gBAAgB,KAAK,KANjC;MAOE,IAAI,EAAC;IAPP,EADF;EALJ,gBAkBE,6BAAC,SAAD;IAAO,KAAK,EAAE,CAAd;IAAiB,OAAO,EAAE;EAA1B,gBACE,6BAAC,SAAD;IAAO,KAAK,EAAE;EAAd,gBACE,6BAAC,QAAD;IAAM,IAAI,EAAE,CAAZ;IAAe,MAAM,EAAC;EAAtB,cADF,eAIE,6BAAC,2BAAD;IAAgB,KAAK,EAAEH,KAAvB;IAA8B,OAAO,EAAEI,OAAvC;IAAgD,KAAK,EAAEsB;EAAvD,EAJF,CADF,eAOE,6BAAC,SAAD;IAAO,KAAK,EAAE;EAAd,gBACE,6BAAC,QAAD;IAAM,IAAI,EAAE,CAAZ;IAAe,MAAM,EAAC;EAAtB,UADF,eAIE,6BAAC,2BAAD;IAAgB,KAAK,EAAEjB,qBAAvB;IAA8C,OAAO,EAAEL,OAAvD;IAAgE,KAAK,EAAEsB;EAAvE,EAJF,CAPF,CAlBF,CADF;AAmCD"}