{"version":3,"file":"Preview.js","names":["MuxVideoPreview","value","React","useState","secrets","setSecrets","useEffect","fetchSecrets","then","_secrets","asset","useMemo","status","playbackId","playbackIds","thumbTime","filename","duration","data","playback_ids"],"sources":["../../src/components/Preview.tsx"],"sourcesContent":["import {SanityDefaultPreview} from 'part:@sanity/base/preview'\nimport React, {useEffect, useMemo} from 'react'\n\nimport {fetchSecrets} from '../actions/secrets'\nimport type {MuxAsset, Secrets, VideoAssetDocument} from '../util/types'\nimport {VideoThumbnail} from './VideoSource.styles'\n\nexport interface MuxVideoPreviewProps {\n  value: {\n    playbackId?: VideoAssetDocument['playbackId']\n    status?: VideoAssetDocument['status']\n    thumbTime?: VideoAssetDocument['thumbTime']\n    filename?: VideoAssetDocument['filename']\n    duration?: MuxAsset['duration']\n    playbackIds?: MuxAsset['playback_ids']\n  }\n}\nconst MuxVideoPreview = ({value = {}}: MuxVideoPreviewProps) => {\n  const [secrets, setSecrets] = React.useState<Secrets | null>(null)\n\n  useEffect(() => void fetchSecrets().then(({secrets: _secrets}) => setSecrets(_secrets!)), [])\n\n  const asset = useMemo(() => {\n    if (!value || value.status !== 'ready' || !value.playbackId || !value.playbackIds) return null\n\n    return {\n      playbackId: value.playbackId,\n      status: value.status,\n      thumbTime: value.thumbTime,\n      filename: value.filename,\n      duration: value.duration,\n      data: {playback_ids: value.playbackIds},\n    }\n  }, [value])\n  if (asset && secrets) {\n    return <VideoThumbnail asset={asset} secrets={secrets} width={640} />\n  }\n\n  const {filename, playbackId, status} = value ?? {}\n\n  return (\n    <SanityDefaultPreview\n      title={filename || playbackId || ''}\n      subtitle={status ? `status: ${status}` : null}\n    />\n  )\n}\n\nexport default MuxVideoPreview\n"],"mappings":";;;;;;;AAAA;;AACA;;AAEA;;AAEA;;;;;;;;;;;;;;;;;;AAYA,IAAMA,eAAe,GAAG,QAAwC;EAAA,sBAAtCC,KAAsC;EAAA,IAAtCA,KAAsC,2BAA9B,EAA8B;;EAC9D,sBAA8BC,cAAA,CAAMC,QAAN,CAA+B,IAA/B,CAA9B;EAAA;EAAA,IAAOC,OAAP;EAAA,IAAgBC,UAAhB;;EAEA,IAAAC,gBAAA,EAAU,MAAM,KAAK,IAAAC,sBAAA,IAAeC,IAAf,CAAoB;IAAA,IAAWC,QAAX,SAAEL,OAAF;IAAA,OAAyBC,UAAU,CAACI,QAAD,CAAnC;EAAA,CAApB,CAArB,EAA0F,EAA1F;EAEA,IAAMC,KAAK,GAAG,IAAAC,cAAA,EAAQ,MAAM;IAC1B,IAAI,CAACV,KAAD,IAAUA,KAAK,CAACW,MAAN,KAAiB,OAA3B,IAAsC,CAACX,KAAK,CAACY,UAA7C,IAA2D,CAACZ,KAAK,CAACa,WAAtE,EAAmF,OAAO,IAAP;IAEnF,OAAO;MACLD,UAAU,EAAEZ,KAAK,CAACY,UADb;MAELD,MAAM,EAAEX,KAAK,CAACW,MAFT;MAGLG,SAAS,EAAEd,KAAK,CAACc,SAHZ;MAILC,QAAQ,EAAEf,KAAK,CAACe,QAJX;MAKLC,QAAQ,EAAEhB,KAAK,CAACgB,QALX;MAMLC,IAAI,EAAE;QAACC,YAAY,EAAElB,KAAK,CAACa;MAArB;IAND,CAAP;EAQD,CAXa,EAWX,CAACb,KAAD,CAXW,CAAd;;EAYA,IAAIS,KAAK,IAAIN,OAAb,EAAsB;IACpB,oBAAO,6BAAC,2BAAD;MAAgB,KAAK,EAAEM,KAAvB;MAA8B,OAAO,EAAEN,OAAvC;MAAgD,KAAK,EAAE;IAAvD,EAAP;EACD;;EAED,YAAuCH,KAAvC,aAAuCA,KAAvC,cAAuCA,KAAvC,GAAgD,EAAhD;EAAA,IAAOe,QAAP,SAAOA,QAAP;EAAA,IAAiBH,UAAjB,SAAiBA,UAAjB;EAAA,IAA6BD,MAA7B,SAA6BA,MAA7B;;EAEA,oBACE,6BAAC,6BAAD;IACE,KAAK,EAAEI,QAAQ,IAAIH,UAAZ,IAA0B,EADnC;IAEE,QAAQ,EAAED,MAAM,qBAAcA,MAAd,IAAyB;EAF3C,EADF;AAMD,CA7BD;;eA+BeZ,e"}